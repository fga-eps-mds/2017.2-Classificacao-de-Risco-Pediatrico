{% extends 'users/user_home/home_layout.html' %}
{% load staticfiles %}

{% block content_pos %}
<!DOCTYPE html>
<body style="height: 100%; margin: 0">
  <div class="row linha">
      <div class="x_title col-md-6">
          <h2>Gráfico de Classificações</h2>
      </div>
  </div>
    <div id="container" style="height: 80%; width: 100%; min-height: 400px"></div>
      <script src="jquery-3.2.1.min.js"></script>
      <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/echarts-all-3.js"></script>
      <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts-stat/ecStat.min.js"></script>
      <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/extension/dataTool.min.js"></script>
      <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/map/js/china.js"></script>
      <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/map/js/world.js"></script>
      <script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=ZUONbpqGBsYGXNIYHicvbAbM"></script>
      <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/extension/bmap.min.js"></script>
      <script type="text/javascript">

        var dom = document.getElementById("container");
        var myChart = echarts.init(dom);
        var legend_data = [];
        var series_data = [];
        var app = {};

        buildData(legend_data, series_data);

        /* PIE CHART:

        option = null;
        option = {
         title : {
             text: 'Gráfico de Classificações',
             subtext: 'Análise de percentual',
             x:'center'
         },
         tooltip : {
             trigger: 'item',
             formatter: "{a} <br/>{b} : {c} ({d}%)"
         },
         legend: {
             orient: 'vertical',
             left: 'left',
             data: legend_data
         },
         series : [
             {
                 name: 'Pie Chart',
                 type: 'pie',
                 radius : '55%',
                 center: ['50%', '50%'],
                 data: series_data,
                 itemStyle: {
                     emphasis: {
                         shadowBlur: 10,
                         shadowOffsetX: 0,
                         shadowColor: 'rgba(0, 0, 0, 0.5)'
                     }
                 }
             }
         ]
       };*/

        option = {
           tooltip : {
               trigger: 'axis',
               axisPointer : {
                   type : 'shadow'
               }
           },
           grid: {
               left: '3%',
               right: '4%',
               bottom: '3%',
               containLabel: true
           },
           xAxis : [
               {
                   type : 'category',
                   data : legend_data,
                   axisTick: {
                       alignWithLabel: true
                   }
               }
           ],
           yAxis : [
               {
                   type : 'value'
               }
           ],
           series : [
               {
                   name:'Classificações',
                   type:'bar',
                   barWidth: '60%',
                  itemStyle: {
                      emphasis: {
                        shadowBlur: 10,
                        shadowOffsetX: 0,
                        shadowColor: 'rgba(0, 0, 0, 0.5)'
                      },
                      normal: {
                        color: function(params) {
                          var colorList = [
                             '#ff3131','#fbff32','#30ff4f','#939393'
                             ];
                          return colorList[params.dataIndex]
                        }
                      }
                  },
                   data:series_data
               }
           ]
        };

        if (option && typeof option === "object") {
         myChart.setOption(option, true);
        }

        function buildData( legend_data, series_data){
          if ({{data.AtendimentoImediato}} != 0){
            legend_data.push("Atendimento Imediato");
            series_data.push({value:{{data.AtendimentoImediato}}});
          }
          if ({{data.AtendimentoHospitalar}} != 0){
            legend_data.push("Atendimento Hospitalar");
            series_data.push({value:{{data.AtendimentoHospitalar}}});
          }
          if ({{data.AtendimentoAmbulatorial}} != 0){
            legend_data.push("Atendimento Ambulatorial");
            series_data.push({value:{{data.AtendimentoAmbulatorial}}});
          }
          if ({{data.AtendimentoEletivo}} != 0){
            legend_data.push("Atendimento Eletivo");
            series_data.push({value:{{data.AtendimentoEletivo}}});
          }
        }

      </script>
{% endblock %}
